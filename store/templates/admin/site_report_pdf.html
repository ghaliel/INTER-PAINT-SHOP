<!DOCTYPE html>
<html>
<head>
    <title>Rapport Professionnel du Site - INTER PAINT</title>
    <style>
        body { font-family: sans-serif; margin: 20mm; font-size: 10pt; line-height: 1.4; }
        h1 { color: #b80000; text-align: center; font-size: 20pt; margin-bottom: 25px; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        h2 { color: #32a8a2; border-bottom: 1px solid #eee; padding-bottom: 5px; margin-top: 30px; font-size: 14pt; }
        h3 { color: #666; margin-top: 15px; font-size: 12pt; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; table-layout: fixed; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; word-wrap: break-word; }
        th { background-color: #f2f2f2; font-weight: bold; }
        .summary-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 30px; }
        .summary-item { background-color: #f9f9f9; padding: 15px; border-radius: 5px; text-align: center; border: 1px solid #ddd; }
        .summary-number { font-size: 1.8em; font-weight: bold; color: #b80000; margin-bottom: 5px; }
        .summary-label { font-size: 0.9em; color: #555; }
        .footer { text-align: center; font-size: 8pt; color: #777; margin-top: 40px; }
        .section-break { page-break-before: always; }
        .note { font-size: 9pt; color: #888; margin-top: 20px; }
    </style>
</head>
<body>
    <h1>RAPPORT PROFESSIONNEL DU SITE INTER PAINT</h1>
    <p style="text-align: center; font-size: 11pt;"><strong>Date de génération:</strong> {{ now|date:"d/m/Y à H:i" }}</p>
    
    <h2>Statistiques Générales du Site</h2>
    <div class="summary-grid">
        <div class="summary-item">
            <div class="summary-number">{{ total_products }}</div>
            <div class="summary-label">Produits en Stock</div>
        </div>
        <div class="summary-item">
            <div class="summary-number">{{ total_categories }}</div>
            <div class="summary-label">Catégories</div>
        </div>
        <div class="summary-item">
            <div class="summary-number">{{ total_users }}</div>
            <div class="summary-label">Utilisateurs Enregistrés</div>
        </div>
        <div class="summary-item">
            <div class="summary-number">{{ total_orders }}</div>
            <div class="summary-label">Commandes Passées</div>
        </div>
        <div class="summary-item">
            <div class="summary-number">{{ total_revenue|floatformat:2 }} MAD</div>
            <div class="summary-label">Chiffre d'Affaires Total</div>
        </div>
    </div>

    <h2>Distribution des Commandes par Statut</h2>
    <table>
        <thead>
            <tr>
                <th style="width: 60%;">Statut</th>
                <th style="width: 40%;">Nombre de Commandes</th>
            </tr>
        </thead>
        <tbody>
            {% for status, count in order_status_counts.items %}
            <tr>
                <td>{{ status }}</td>
                <td>{{ count }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    {% if top_selling_products %}
    <h2>Top 5 des Produits les Plus Vendus</h2>
    <table>
        <thead>
            <tr>
                <th style="width: 40%;">Produit</th>
                <th style="width: 30%;">Couleur</th>
                <th style="width: 30%; text-align: center;">Quantité Totale Vendue</th>
            </tr>
        </thead>
        <tbody>
            {% for product in top_selling_products %}
            <tr>
                <td>{{ product.product__name }}</td>
                <td>{{ product.product__color }}</td>
                <td style="text-align: center;">{{ product.total_quantity }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}

    <p class="note">Ce rapport fournit un aperçu des données clés du site INTER PAINT. Les chiffres sont mis à jour à la date et l'heure de génération du rapport.</p>

    <h2>Informations de Contact</h2>
    <p>
        <strong>Adresse:</strong> Gueliz<br>
        <strong>Ville:</strong> Marrakech<br>
        <strong>Code Postal:</strong> 40000<br>
        <strong>Pays:</strong> Maroc<br>
        <strong>Téléphone:</strong> +212 645 250 178<br>
        <strong>Email:</strong> elasrighali2003@gmail.com
    </p>

    <div class="footer">
        INTER PAINT Ltd - Rapport Professionnel du Site<br>
        Généré le {{ now|date:"d/m/Y à H:i" }}
    </div>
</body>
</html> 